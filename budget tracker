import csv
import matplotlib.pyplot as plt

categories = ["Rent", "Food", "Transportation", "Savings", "Entertainment", "Other"]

def create_budget():
    income = float(input("Enter your monthly income: $"))
    expenses = {}

    print("\nEnter how much you want to spend in each category:")
    for category in categories:
        amount = float(input(f"{category}: $"))
        expenses[category] = amount

    total_expenses = sum(expenses.values())
    leftover = income - total_expenses
    expenses["Leftover"] = leftover


    with open("budget.csv", "w", newline="") as file:
        writer = csv.writer(file)
        writer.writerow(["Category", "Amount"])
        for category, amount in expenses.items():
            writer.writerow([category, amount])

    print(" Budget saved to 'budget.csv'!")
    show_pie_chart(expenses)

def load_budget(filename="budget.csv"):
    try:
        categories = []
        amounts = []

        with open(filename, "r") as file:
            reader = csv.reader(file)
            next(reader)  
            for row in reader:
                categories.append(row[0])
                amounts.append(float(row[1]))

        expenses = dict(zip(categories, amounts))
        show_pie_chart(expenses, title="Loaded Monthly Budget Breakdown")

    except FileNotFoundError:
        print(" No saved budget found. Please create a budget first.")

def show_pie_chart(expenses, title="Monthly Budget Breakdown"):
    labels = list(expenses.keys())
    values = list(expenses.values())

    plt.figure(figsize=(8, 6))
    plt.pie(values, labels=labels, autopct="%1.1f%%", startangle=90)
    plt.title(title)
    plt.axis("equal")
    plt.show()

def main():
    while True:
        print("\n=== Budgeting Tool ===")
        print("1. Create new budget")
        print("2. View saved budget")
        print("3. Exit")

        choice = input("Choose an option (1-3): ").strip()

        if choice == "1":
            create_budget()
        elif choice == "2":
            load_budget()
        elif choice == "3":
            print("Goodbye!")
            break
        else:
            print("Invalid choice. Please enter 1, 2, or 3")
